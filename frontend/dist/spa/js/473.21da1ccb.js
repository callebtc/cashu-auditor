"use strict";(globalThis["webpackChunkcashu_auditor_frontend"]=globalThis["webpackChunkcashu_auditor_frontend"]||[]).push([[473],{5473:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Pt});var n=a(1758);function o(e,t,a,o,s,l){const r=(0,n.g2)("StatsCard"),i=(0,n.g2)("GlobalSwapBarChart"),c=(0,n.g2)("MintList"),u=(0,n.g2)("MintGraph"),d=(0,n.g2)("SwapList");return(0,n.uX)(),(0,n.CE)(n.FK,null,[t[0]||(t[0]=(0,n.Lk)("div",{class:"q-pa-md"},[(0,n.Lk)("h1",{class:"text-h6"},"Lightning Auditor"),(0,n.Lk)("p",null," Donate Ecash from any Cashu mint so it can be audited perpetually. This app sends random Lightning payments between mints. Forever. The sats go in a circle until all is lost to fees or rugs. If a mint fails to pay an invoice, it is marked with a scary red label. ")],-1)),(0,n.bF)(r),(0,n.bF)(i,{maxSwaps:1e3}),(0,n.bF)(c),(0,n.bF)(u),(0,n.bF)(d)],64)}var s=a(8790),l=a(9104);const r={class:"text-left",style:{"font-family":"monospace"}},i={class:"text-left"},c={class:"text-left"},u={class:"text-left"},d={class:"text-left"},p={class:"text-left"};function m(e,t,a,o,m,v){const f=(0,n.g2)("TokenInput"),g=(0,n.g2)("q-tooltip"),h=(0,n.g2)("q-btn"),y=(0,n.g2)("q-icon"),w=(0,n.g2)("q-badge"),b=(0,n.g2)("q-table"),k=(0,n.g2)("MintSwapStats");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(f,{token:e.token,"onUpdate:token":t[0]||(t[0]=t=>e.token=t),submittingToken:e.submittingToken,error:e.error,onSubmit:e.submitToken},null,8,["token","submittingToken","error","onSubmit"]),(0,n.bF)(b,{title:"Mints",rows:e.mints,columns:e.columns,"row-key":"id",loading:e.loading,"hide-bottom":e.mints.length>0,"rows-per-page-options":[0],onRowClick:e.onRowClick},{"top-right":(0,n.k6)((()=>t[2]||(t[2]=[(0,n.Lk)("div",{class:"text-caption text-grey-7"},"Click on a mint to get more information",-1)]))),"body-cell-url":(0,n.k6)((a=>[(0,n.Lk)("td",r,[(0,n.eW)((0,s.v_)(a.row.url)+" ",1),(0,n.bF)(h,{flat:"",round:"",dense:"",size:"xs",icon:"content_copy",onClick:(0,l.D$)((t=>e.copyToClipboard(a.row.url)),["stop"]),class:"copy-btn"},{default:(0,n.k6)((()=>[(0,n.bF)(g,null,{default:(0,n.k6)((()=>t[3]||(t[3]=[(0,n.eW)("Copy URL")]))),_:1})])),_:2},1032,["onClick"])])])),"body-cell-updated_at":(0,n.k6)((t=>[(0,n.Lk)("td",i,(0,s.v_)(e.formatDate(t.row.updated_at)),1)])),"body-cell-next_update":(0,n.k6)((t=>[(0,n.Lk)("td",c,(0,s.v_)(e.formatDate(t.row.next_update)),1)])),"body-cell-state":(0,n.k6)((t=>[(0,n.Lk)("td",u,[(0,n.bF)(y,{name:e.getStateIcon(t.row.state).name,color:e.getStateIcon(t.row.state).color},null,8,["name","color"])])])),"body-cell-n_errors":(0,n.k6)((e=>[(0,n.Lk)("td",d,[(0,n.bF)(w,{color:e.row.n_errors>0&&"ERROR"==e.row.state?"negative":"grey-7"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.row.n_errors),1)])),_:2},1032,["color"])])])),"body-cell-n_melts":(0,n.k6)((e=>[(0,n.Lk)("td",p,[(0,n.bF)(w,{color:e.row.n_melts>0&&"OK"==e.row.state?"positive":"grey-7","text-color":"dark"},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.row.n_melts),1)])),_:2},1032,["color"])])])),_:1},8,["rows","columns","loading","hide-bottom","onRowClick"]),e.selectedMint?((0,n.uX)(),(0,n.Wv)(k,{key:0,modelValue:e.showSwapStats,"onUpdate:modelValue":t[1]||(t[1]=t=>e.showSwapStats=t),mint:e.selectedMint},null,8,["modelValue","mint"])):(0,n.Q3)("",!0)])}var v=a(8734),f=a(2303);const g=f.A.create({baseURL:"https://api.audit.8333.space",headers:{"Content-Type":"application/json"}}),h=g;var y=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function l(e){try{i(n.next(e))}catch(t){s(t)}}function r(e){try{i(n["throw"](e))}catch(t){s(t)}}function i(e){e.done?a(e.value):o(e.value).then(l,r)}i((n=n.apply(e,t||[])).next())}))};const w=(e=0,t=0)=>y(void 0,void 0,void 0,(function*(){const a=yield h.get("/mints/",{params:{skip:e,limit:t}});return console.log("API Response:",a.data),a.data})),b=e=>y(void 0,void 0,void 0,(function*(){const t=yield h.post("/mints/",e);return console.log("API Response:",t.data),t.data})),k=(e=0,t=10)=>y(void 0,void 0,void 0,(function*(){const a=yield h.get("/swaps/",{params:{skip:e,limit:t}});return console.log("API Response:",a.data),a.data})),_=()=>y(void 0,void 0,void 0,(function*(){const e=yield h.get("/graph/");return console.log("API Response:",e.data),e.data})),x=()=>y(void 0,void 0,void 0,(function*(){const e=yield h.get("/stats/");return console.log("API Response:",e.data),e.data}));function S(e,t=0,a=10){return y(this,void 0,void 0,(function*(){const n=yield h.get(`/swaps/mint/${e}?skip=${t}&limit=${a}`);return n.data}))}function T(){return y(this,void 0,void 0,(function*(){const e=yield h.get("/pr");return e.data}))}const L={class:"text-h4 text-wrap"},R={class:"text-center text-wrap",style:{"font-family":"monospace"}},q={class:"row q-col-gutter-md q-px-md",style:{"flex-wrap":"nowrap"}},C={class:"text-h5"},M={class:"text-caption"},F={class:"text-h5"},A={style:{"font-family":"monospace"}},W={key:0,class:"text-secondary q-pa-md text-center",style:{"font-size":"1.2rem"}},D={key:1,class:"text-secondary q-pa-md text-center",style:{"font-size":"1.2rem"}};function E(e,t,a,o,l,r){const i=(0,n.g2)("q-icon"),c=(0,n.g2)("q-card-actions"),u=(0,n.g2)("q-card-section"),d=(0,n.g2)("q-img"),p=(0,n.g2)("q-avatar"),m=(0,n.g2)("q-btn"),v=(0,n.g2)("MintWarningBox"),f=(0,n.g2)("q-card"),g=(0,n.g2)("MintSwapBarChart"),h=(0,n.g2)("q-item-label"),y=(0,n.g2)("q-item-section"),w=(0,n.g2)("q-item"),b=(0,n.g2)("q-list"),k=(0,n.g2)("q-dialog"),_=(0,n.gN)("close-popup");return(0,n.uX)(),(0,n.Wv)(k,{modelValue:e.show,"onUpdate:modelValue":t[1]||(t[1]=t=>e.show=t),maximized:e.$q.screen.lt.md,"transition-show":"fade","transition-hide":"fade"},{default:(0,n.k6)((()=>[(0,n.bF)(f,{class:"bg-dark q-pa-sm text-white rounded-borders",style:(0,s.Tr)(e.$q.screen.gt.sm?{"min-width":"600px"}:null)},{default:(0,n.k6)((()=>[(0,n.bF)(c,{class:"close-button-container"},{default:(0,n.k6)((()=>[(0,n.bo)((0,n.bF)(i,{name:"close",class:"cursor-pointer text-white"},null,512),[[_]])])),_:1}),(0,n.bF)(u,{class:(0,s.C4)(["row justify-center text-center q-px-xl",(e.mintIconUrl,"q-pb-md")])},{default:(0,n.k6)((()=>[(0,n.Lk)("div",L,(0,s.v_)(e.mint.name||e.mint.url),1)])),_:1},8,["class"]),e.mintIconUrl?((0,n.uX)(),(0,n.Wv)(u,{key:0,class:"row justify-center q-pb-lg q-pt-none"},{default:(0,n.k6)((()=>[(0,n.bF)(p,{size:"75px",class:"q-mb-none"},{default:(0,n.k6)((()=>[(0,n.bF)(d,{"spinner-color":"white","spinner-size":"xs",src:e.mintIconUrl,alt:"Mint Icon",style:{height:"75px","max-width":"75px","font-size":"12px"}},null,8,["src"])])),_:1})])),_:1})):(0,n.Q3)("",!0),(0,n.bF)(u,{class:"row justify-center q-py-sm"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",R,(0,s.v_)(e.mint.url),1),(0,n.bF)(m,{flat:"",round:"",dense:"",size:"xs",class:"q-ml-sm",style:{"margin-top":"2px"},icon:"content_copy",onClick:t[0]||(t[0]=t=>e.copyToClipboard(e.mint.url,"Mint URL copied to clipboard"))})])),_:1}),(0,n.bF)(u,{class:"q-pb-md"},{default:(0,n.k6)((()=>[(0,n.bF)(v,{mint:e.mint,swaps:e.swaps,"could-fetch-info":e.couldFetchInfo},null,8,["mint","swaps","could-fetch-info"])])),_:1}),(0,n.bF)(u,{class:"q-py-none"},{default:(0,n.k6)((()=>[(0,n.Lk)("div",q,[(0,n.bF)(f,{class:"col-6 stat-card"},{default:(0,n.k6)((()=>[(0,n.bF)(u,null,{default:(0,n.k6)((()=>[t[2]||(t[2]=(0,n.Lk)("div",{class:"text-subtitle1"},"Success Rate",-1)),(0,n.Lk)("div",C,(0,s.v_)(e.successRate)+"%",1),(0,n.Lk)("div",M,(0,s.v_)(e.successfulSwaps)+" of "+(0,s.v_)(e.swaps.length)+" swaps ",1)])),_:1})])),_:1}),(0,n.bF)(f,{class:"col-6 stat-card q-ml-md"},{default:(0,n.k6)((()=>[(0,n.bF)(u,null,{default:(0,n.k6)((()=>[t[3]||(t[3]=(0,n.Lk)("div",{class:"text-subtitle1"},"Average Time",-1)),(0,n.Lk)("div",F,(0,s.v_)(e.formatTime(e.averageTime)),1),t[4]||(t[4]=(0,n.Lk)("div",{class:"text-caption"}," For successful swaps ",-1))])),_:1})])),_:1})])])),_:1}),e.swaps.length>0?((0,n.uX)(),(0,n.Wv)(u,{key:1,class:"q-pb-none"},{default:(0,n.k6)((()=>[(0,n.bF)(g,{swaps:e.swaps},null,8,["swaps"])])),_:1})):(0,n.Q3)("",!0),(0,n.bF)(u,null,{default:(0,n.k6)((()=>[t[11]||(t[11]=(0,n.Lk)("div",{class:"text-h6 q-mb-md"},"Recent Swaps",-1)),(0,n.bF)(b,{bordered:"",separator:"",class:"scroll",style:{"max-height":"400px"},ref:"swapList"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.swaps,(a=>((0,n.uX)(),(0,n.Wv)(w,{key:a.id,class:"q-py-md"},{default:(0,n.k6)((()=>[(0,n.bF)(y,null,{default:(0,n.k6)((()=>[(0,n.bF)(h,null,{default:(0,n.k6)((()=>[t[5]||(t[5]=(0,n.Lk)("span",{class:"text-bold"},"To:",-1)),t[6]||(t[6]=(0,n.eW)()),(0,n.Lk)("span",A,(0,s.v_)(a.to_url),1)])),_:2},1024),(0,n.bF)(h,null,{default:(0,n.k6)((()=>[t[7]||(t[7]=(0,n.Lk)("span",{class:"text-bold"},"Amount:",-1)),(0,n.eW)(" "+(0,s.v_)(a.amount)+" sat ",1)])),_:2},1024),(0,n.bF)(h,null,{default:(0,n.k6)((()=>[t[8]||(t[8]=(0,n.Lk)("span",{class:"text-bold"},"Time:",-1)),(0,n.eW)(" "+(0,s.v_)(e.formatDate(a.created_at)),1)])),_:2},1024),"OK"===a.state?((0,n.uX)(),(0,n.Wv)(h,{key:0,caption:""},{default:(0,n.k6)((()=>[t[9]||(t[9]=(0,n.Lk)("span",{class:"text-bold"},"Fee:",-1)),(0,n.eW)(" "+(0,s.v_)(a.fee)+" sat ",1),a.time_taken?((0,n.uX)(),(0,n.Wv)(h,{key:0,caption:""},{default:(0,n.k6)((()=>[(0,n.eW)(" Payment took "+(0,s.v_)(a.time_taken)+" ms ",1)])),_:2},1024)):(0,n.Q3)("",!0)])),_:2},1024)):(0,n.Q3)("",!0),"ERROR"===a.state&&a.error?((0,n.uX)(),(0,n.Wv)(h,{key:1,caption:""},{default:(0,n.k6)((()=>[t[10]||(t[10]=(0,n.Lk)("span",{class:"text-bold"},"Error:",-1)),(0,n.eW)(" "+(0,s.v_)(a.error),1)])),_:2},1024)):(0,n.Q3)("",!0)])),_:2},1024),(0,n.bF)(y,{side:""},{default:(0,n.k6)((()=>[(0,n.bF)(i,{name:"OK"===a.state?"check_circle":"cancel",color:"OK"===a.state?"positive":"negative"},null,8,["name","color"])])),_:2},1024)])),_:2},1024)))),128)),(0,n.bF)(w,{class:"q-pa-md"},{default:(0,n.k6)((()=>[(0,n.bF)(y,{class:"q-flex justify-center"},{default:(0,n.k6)((()=>[e.loadingInitial||0!==e.swaps.length?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",W," No swaps found ")),e.allLoaded&&e.swaps.length>0?((0,n.uX)(),(0,n.CE)("div",D," All swaps loaded ")):(0,n.Q3)("",!0),(0,n.bF)(h,{class:"text-center"},{default:(0,n.k6)((()=>[e.allLoaded?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(m,{key:0,label:"Load More Swaps",outline:"",color:"primary",onClick:e.loadMoreSwaps,disabled:e.loadingMore,loading:e.loadingMore},null,8,["onClick","disabled","loading"]))])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})])),_:1},8,["style"])])),_:1},8,["modelValue","maximized"])}const $={class:"bar-chart-container",ref:"chartContainer"},I={class:"chart-wrapper"},K={class:"bars-container"},Q=["onMouseover"],X={class:"time-axis"},N=["innerHTML"];function B(e,t,a,o,l,r){return(0,n.uX)(),(0,n.CE)("div",$,[(0,n.Lk)("div",I,[(0,n.Lk)("div",K,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.displayBuckets,((a,o)=>((0,n.uX)(),(0,n.CE)("div",{key:`bucket-${o}`,class:(0,s.C4)(["bar",{placeholder:0===a.count}]),style:(0,s.Tr)({width:`${e.barWidth}px`,left:o*(e.barWidth+e.spacing)+"px",backgroundColor:a.count>0?e.getSuccessColor(a.successRate):"transparent"}),onMouseover:t=>e.showBucketTooltip(t,a),onMouseleave:t[0]||(t[0]=(...t)=>e.hideTooltip&&e.hideTooltip(...t))},null,46,Q)))),128))]),(0,n.Lk)("div",X,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.timeTicks,((t,a)=>((0,n.uX)(),(0,n.CE)("div",{key:a,class:"time-tick",style:(0,s.Tr)({left:a/(e.timeTicks.length-1)*100+"%",display:a===e.timeTicks.length-1?"none":"block"})},(0,s.v_)(e.formatTime(t)),5)))),128))])]),e.tooltip.show?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"tooltip",style:(0,s.Tr)({left:e.tooltip.x+"px",top:e.tooltip.y+"px"})},[(0,n.Lk)("div",{innerHTML:e.tooltip.content},null,8,N)],4)):(0,n.Q3)("",!0)],512)}const O=(0,n.pM)({name:"MintSwapBarChart",props:{swaps:{type:Array,required:!0},minBars:{type:Number,default:16},maxPossibleBars:{type:Number,default:200},barSpacing:{type:Number,default:2},minBarWidth:{type:Number,default:2}},setup(e){const t=(0,v.KR)({show:!1,x:0,y:0,content:""}),a=(0,v.KR)(null),o=(0,v.KR)(0),s=(0,n.EW)((()=>e.barSpacing)),l=(0,n.EW)((()=>e.minBarWidth)),r=(0,n.EW)((()=>{if(o.value<=0)return e.minBars;const t=200,a=2600;if(o.value<=t)return e.minBars;if(o.value>=a)return e.maxPossibleBars;{const n=(o.value-t)/(a-t);return Math.floor(e.minBars+n*(e.maxPossibleBars-e.minBars))}})),i=(0,n.EW)((()=>{if(o.value<=0)return r.value;const e=Math.floor((o.value+s.value)/(l.value+s.value));return Math.min(e,r.value)})),c=(0,n.EW)((()=>o.value<=0||i.value<=0?l.value:Math.max(l.value,(o.value-s.value*(i.value-1))/i.value))),u=()=>{if(a.value){const e=a.value.querySelector(".bars-container");e&&(o.value=e.clientWidth)}};(0,n.sV)((()=>{u();const e=new ResizeObserver((()=>{u()}));return a.value&&e.observe(a.value),window.addEventListener("resize",u),()=>{e.disconnect(),window.removeEventListener("resize",u)}}));const d=(0,n.EW)((()=>{if(0===e.swaps.length)return[];const t=new Date(e.swaps[0].created_at).getTime(),a=new Date(e.swaps[e.swaps.length-1].created_at).getTime(),n=(t-a)/3;return Array.from({length:4},((e,t)=>new Date(a+n*t)))})),p=(0,n.EW)((()=>{if(0===e.swaps.length)return Array(i.value).fill({swaps:[],count:0,successCount:0,successRate:0,startTime:new Date,endTime:new Date});const t=[...e.swaps].sort(((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime())),a=new Date(t[t.length-1].created_at).getTime(),n=new Date(t[0].created_at).getTime(),o=a-n,s=Array(i.value).fill(null).map((()=>({swaps:[],count:0,successCount:0,successRate:0,startTime:new Date,endTime:new Date})));if(0===o)return s[0].swaps=[...t],s[0].count=t.length,s[0].successCount=t.filter((e=>"OK"===e.state)).length,s[0].successRate=s[0].count>0?s[0].successCount/s[0].count:0,s[0].startTime=new Date(n),s[0].endTime=new Date(a),s;const l=o/i.value;for(let e=0;e<i.value;e++){const t=i.value-1-e,a=n+t*l,o=n+(t+1)*l;s[e].startTime=new Date(a),s[e].endTime=new Date(o)}return t.forEach((e=>{const t=new Date(e.created_at).getTime(),a=(t-n)/o,l=1-a,r=Math.min(Math.floor(l*i.value),i.value-1);r>=0&&(s[r].swaps.push(e),s[r].count++,"OK"===e.state&&s[r].successCount++)})),s.forEach((e=>{e.successRate=e.count>0?e.successCount/e.count:0})),s})),m=e=>{if(1===e)return"#4CAF50";if(0===e)return"#f44336";if(e<.5){const t=244,a=Math.floor(67+2*e*98),n=54;return`rgb(${t}, ${a}, ${n})`}{const t=Math.floor(244-2*(e-.5)*168),a=Math.floor(165+2*(e-.5)*10),n=Math.floor(54-2*(e-.5)*4);return`rgb(${t}, ${a}, ${n})`}},f=t=>{if(e.swaps.length>0){const a=new Date(e.swaps[e.swaps.length-1].created_at).getTime();if(Math.abs(t.getTime()-a)<1e3)return"Now"}const a=new Date,n=t.toDateString()===a.toDateString(),o=new Date(a.setDate(a.getDate()-1)).toDateString()===t.toDateString();let s="";return s=n?"Today":o?"Yesterday":t.toLocaleDateString(void 0,{month:"short",day:"numeric"}),`${s} ${t.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",hour12:!1})}`},g=e=>{const t=/([Zz]|[+\-]\d{2}:\d{2})$/.test(e);let a=e;t||(a+="Z");const n=new Date(a);if(isNaN(n.getTime()))return"Invalid Date";const o=new Date,s=n.toDateString()===o.toDateString(),l=new Date(o.setDate(o.getDate()-1)).toDateString()===n.toDateString();let r="";return r=s?"Today":l?"Yesterday":n.toLocaleDateString(void 0,{month:"short",day:"numeric"}),`${r} ${n.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",hour12:!1})}`},h=(e,a)=>{if(0===a.count)return void y();const n=Math.round(100*a.successRate);let o="";a.startTime&&a.endTime&&(o=`${g(a.startTime.toISOString())} - ${g(a.endTime.toISOString())}`),t.value={show:!0,x:e.clientX+10,y:e.clientY+10,content:`\n          <div><b>Swaps:</b> ${a.count}</div>\n          <div><b>Success rate:</b> ${n}% (${a.successCount}/${a.count})</div>\n          <div><b>Time range:</b> ${o}</div>\n        `}},y=()=>{t.value.show=!1};return{tooltip:t,timeTicks:d,displayBuckets:p,chartContainer:a,barsCount:i,barWidth:c,spacing:s,maxBars:r,formatTime:f,formatDate:g,showBucketTooltip:h,hideTooltip:y,getSuccessColor:m}}});var V=a(2807);const P=(0,V.A)(O,[["render",B],["__scopeId","data-v-98d49a96"]]),z=P,U={key:0,class:"warning-container"},j={class:"warning-content"},G={class:"warning-text-container"},Y={class:"warning-messages"},Z={class:"warning-list"};function H(e,t,a,o,l,r){const i=(0,n.g2)("q-icon");return e.hasWarnings?((0,n.uX)(),(0,n.CE)("div",U,[(0,n.Lk)("div",j,[(0,n.bF)(i,{name:"warning",size:"24px",class:"warning-icon"}),(0,n.Lk)("div",G,[t[0]||(t[0]=(0,n.Lk)("div",{class:"warning-header"},[(0,n.Lk)("div",{class:"warning-title"},"Auditor Warnings")],-1)),(0,n.Lk)("div",Y,[(0,n.Lk)("ul",Z,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.warningMessages,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t,class:"warning-message"},(0,s.v_)(e),1)))),128))])])])])])):(0,n.Q3)("",!0)}const J=(0,n.pM)({name:"MintWarningBox",props:{mint:{type:Object,required:!0},swaps:{type:Array,required:!0},couldFetchInfo:{type:Boolean,default:!0},inactiveThresholdDays:{type:Number,default:2},recentDaysThreshold:{type:Number,default:7},successRateThreshold:{type:Number,default:85},slowMintThresholdMs:{type:Number,default:5e3},requiredSuccessfulSwaps:{type:Number,default:7}},setup(e){const t=(0,n.EW)((()=>{const t=[];e.couldFetchInfo||t.push("We were not able to reach the mint. Mint might be offline.");const a=new Date,n=e.swaps.filter((t=>{const n=new Date(t.created_at),o=(a.getTime()-n.getTime())/864e5;return o<=e.recentDaysThreshold})),o=n.filter((e=>"OK"===e.state)),s=n.length>0?o.length/n.length*100:0;if("WARN"===e.mint.state||"ERROR"===e.mint.state){const a="A recent swap has failed.";if(n.length>0){let l=`${o.length} of ${n.length} swaps in the last ${e.recentDaysThreshold} days succeeded.`;s>=e.successRateThreshold?t.push(`${a} However, ${l}. This mint seems reliable, failures might be due to the receiving mint.`):t.push(`${a} Only ${l}. This mint might be unreliable.`)}else t.push(a)}else if("UNKNOWN"===e.mint.state)t.push("The auditor was not able to determine the quality of this mint yet.");else if("OK"===e.mint.state){const a=[];o.length<e.requiredSuccessfulSwaps&&a.push(`We do not have much data on this mint yet. Only ${o.length} successful ${1===o.length?"swap":"swaps"} in ${e.recentDaysThreshold} days.`),n.length>0&&s<e.successRateThreshold&&a.push(`This success rate was only ${Math.round(s)}% in the last ${e.recentDaysThreshold} days, below the recommended ${e.successRateThreshold}%.`),a.length>0&&t.push(...a)}const l=e.swaps.filter((e=>"OK"===e.state));if(l.length>0){const a=new Date(l[0].created_at),n=new Date,o=(n.getTime()-a.getTime())/864e5;if(o>e.inactiveThresholdDays){const e=Math.floor(o),a=`This mint had no swaps for ${e} ${1===e?"day":"days"}. It might be unreachable.`;t.push(a)}const s=l.filter((e=>e.time_taken));if(s.length>0){const a=s.reduce(((e,t)=>e+(t.time_taken||0)),0),n=a/s.length;if(n>e.slowMintThresholdMs){const e=(n/1e3).toFixed(1);t.push(`This mint is slow. Payments from this mint took ${e} seconds on average.`)}}}else e.swaps.length>0&&t.push("No successful swaps recorded for this mint. It might be unreachable.");return t})),a=(0,n.EW)((()=>t.value.length>0));return{warningMessages:t,hasWarnings:a}}});var ee=a(492),te=a(8582),ae=a.n(te);const ne=(0,V.A)(J,[["render",H],["__scopeId","data-v-41e6734c"]]),oe=ne;ae()(J,"components",{QIcon:ee.A});var se=a(989);const le=(e,t="Copied to clipboard")=>{navigator.clipboard.writeText(e).then((()=>{se.A.create({message:t,color:"positive",position:"top",timeout:1500})})).catch((e=>{console.error("Failed to copy text: ",e),se.A.create({message:"Failed to copy",color:"negative",position:"top"})}))};var re=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function l(e){try{i(n.next(e))}catch(t){s(t)}}function r(e){try{i(n["throw"](e))}catch(t){s(t)}}function i(e){e.done?a(e.value):o(e.value).then(l,r)}i((n=n.apply(e,t||[])).next())}))};const ie=(0,n.pM)({name:"MintSwapStats",components:{MintSwapBarChart:z,MintWarningBox:oe},props:{modelValue:{type:Boolean,required:!0},mint:{type:Object,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,v.KR)([]),o=(0,v.KR)(!1),s=(0,v.KR)(!1),l=(0,v.KR)(0),r=100,i=(0,v.KR)(!1),c=(0,v.KR)(null),u=(0,v.KR)(void 0),d=(0,v.KR)(!0),p=(0,n.EW)({get:()=>e.modelValue,set:e=>t("update:modelValue",e)});(0,n.wB)(p,(t=>{t&&(l.value=0,i.value=!1,h("initial"),x(e.mint))}));const m=(0,n.EW)((()=>a.value.filter((e=>"OK"===e.state)).length)),f=(0,n.EW)((()=>0===a.value.length?0:Math.round(m.value/a.value.length*100))),g=(0,n.EW)((()=>{const e=a.value.filter((e=>"OK"===e.state&&e.time_taken));if(0===e.length)return 0;const t=e.reduce(((e,t)=>e+(t.time_taken||0)),0);return t/e.length})),h=t=>re(this,void 0,void 0,(function*(){"initial"===t?o.value=!0:s.value=!0;try{const n=yield S(e.mint.id,l.value,r);a.value="initial"===t?n:[...a.value,...n],l.value+=r,i.value=n.length<r}catch(n){console.error("Error fetching swaps:",n)}finally{"initial"===t?o.value=!1:s.value=!1}})),y=()=>re(this,void 0,void 0,(function*(){var e;if(i.value||s.value)return;const t=(null===(e=c.value)||void 0===e?void 0:e.scrollTop)||0;yield h("more"),(0,n.dY)((()=>{c.value&&(c.value.scrollTop=t)}))})),w=e=>{if(0===e)return"N/A";const t=e/1e3;return t<10?`${e.toFixed(0)} ms`:`${t.toFixed(2)} s`},b=e=>{const t=/([Zz]|[+\-]\d{2}:\d{2})$/.test(e);let a=e;t||(a+="Z");const n=new Date(a);if(isNaN(n.getTime()))return console.error(`Invalid date string: ${e}`),"Invalid Date";const o={hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},s={year:"numeric",month:"short",day:"numeric"},l=n.toLocaleTimeString(void 0,o),r=n.toLocaleDateString(void 0,s);return`${l}, ${r}`},k=e=>`Mint ${e}`,_=e=>re(this,void 0,void 0,(function*(){try{const t=yield fetch(e.url+"/v1/info"),a=yield t.json();return d.value=!0,a}catch(Ne){return console.error("Error fetching mint info:",Ne),d.value=!1,null}})),x=e=>re(this,void 0,void 0,(function*(){try{u.value=void 0;const t=yield _(e);if(!t.icon_url||!t.icon_url.startsWith("https://")&&!t.icon_url.startsWith("http://"))return;u.value=t.icon_url}catch(Ne){console.error("Error fetching mint icon:",Ne),u.value=void 0}}));return(0,n.sV)((()=>{h("initial"),x(e.mint)})),{swapList:c,show:p,swaps:a,loadingInitial:o,loadingMore:s,allLoaded:i,successRate:f,successfulSwaps:m,averageTime:g,formatTime:w,getMintName:k,loadMoreSwaps:y,formatDate:b,mintIconUrl:u,copyToClipboard:le,couldFetchInfo:d}}});var ce=a(558),ue=a(3316),de=a(2669),pe=a(4189),me=a(3952),ve=a(2665),fe=a(1693),ge=a(3999),he=a(124),ye=a(5173),we=a(3796),be=a(8672);const ke=(0,V.A)(ie,[["render",E],["__scopeId","data-v-261b639e"]]),_e=ke;ae()(ie,"components",{QDialog:ce.A,QCard:ue.A,QCardActions:de.A,QIcon:ee.A,QCardSection:pe.A,QAvatar:me.A,QImg:ve.A,QBtn:fe.A,QList:ge.A,QItem:he.A,QItemSection:ye.A,QItemLabel:we.A}),ae()(ie,"directives",{ClosePopup:be.A});const xe={class:"q-pa-md"},Se={class:"q-mt-md row justify-end"},Te={key:0,class:"text-negative q-pa-md"},Le={key:1,class:"q-pa-md q-mt-md"},Re={class:"row text-center items-center justify-center"},qe={class:"row text-center items-center justify-center"},Ce={class:"row text-center items-center justify-center q-mb-md"};function Me(e,t,a,o,r,i){const c=(0,n.g2)("q-item-label"),u=(0,n.g2)("q-spinner"),d=(0,n.g2)("q-btn"),p=(0,n.g2)("q-input"),m=(0,n.g2)("qrcode"),v=(0,n.g2)("q-icon");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",xe,[(0,n.bF)(c,{class:"text-h6 q-mb-md",color:"white"},{default:(0,n.k6)((()=>t[3]||(t[3]=[(0,n.eW)("Donate Ecash")]))),_:1}),(0,n.bF)(p,{filled:"",modelValue:e.tokenValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tokenValue=t),label:"Enter Token",onKeyup:(0,l.jR)(e.handleSubmit,["enter"]),class:"rounded-borders"},{append:(0,n.k6)((()=>[(0,n.bF)(d,{color:"primary",onClick:e.handleSubmit},{default:(0,n.k6)((()=>[e.submitting?((0,n.uX)(),(0,n.Wv)(u,{key:0,size:"15px",class:"q-mr-sm",color:"white"})):(0,n.Q3)("",!0),t[4]||(t[4]=(0,n.eW)("Submit "))])),_:1},8,["onClick"])])),_:1},8,["modelValue","onKeyup"]),(0,n.Lk)("div",Se,[e.paymentRequestString?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(d,{key:0,color:"primary",onClick:e.createPaymentRequest,loading:e.loadingPaymentRequest},{default:(0,n.k6)((()=>t[5]||(t[5]=[(0,n.eW)("Payment Request")]))),_:1},8,["onClick","loading"]))])]),e.errorMessage?((0,n.uX)(),(0,n.CE)("div",Te,(0,s.v_)(e.errorMessage),1)):(0,n.Q3)("",!0),e.paymentRequestString?((0,n.uX)(),(0,n.CE)("div",Le,[(0,n.Lk)("div",Re,[(0,n.bF)(m,{value:e.paymentRequestString,options:{width:200},class:"q-mb-md"},null,8,["value"])]),(0,n.Lk)("div",qe,[(0,n.bF)(p,{modelValue:e.paymentRequestString,"onUpdate:modelValue":t[2]||(t[2]=t=>e.paymentRequestString=t),class:"q-mb-md",style:{"font-family":"monospace","font-size":"12px","max-width":"400px"},readonly:""},{append:(0,n.k6)((()=>[(0,n.bF)(v,{name:"content_copy",color:"grey",size:"xs",onClick:t[1]||(t[1]=t=>e.copyToClipboard(e.paymentRequestString))})])),_:1},8,["modelValue"])]),(0,n.Lk)("div",Ce,[(0,n.bF)(d,{color:"primary",outline:"",onClick:e.hidePaymentRequest},{default:(0,n.k6)((()=>t[6]||(t[6]=[(0,n.eW)("Hide")]))),_:1},8,["onClick"])])])):(0,n.Q3)("",!0)])}var Fe=a(552),Ae=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function l(e){try{i(n.next(e))}catch(t){s(t)}}function r(e){try{i(n["throw"](e))}catch(t){s(t)}}function i(e){e.done?a(e.value):o(e.value).then(l,r)}i((n=n.apply(e,t||[])).next())}))};const We=(0,n.pM)({name:"TokenInput",components:{qrcode:Fe.A},props:{token:{type:String,default:""},submittingToken:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["update:token","submit"],setup(e,{emit:t}){const a=(0,v.KR)(e.token),o=(0,v.KR)(e.submittingToken),s=(0,v.KR)(e.error),l=(0,v.KR)(""),r=(0,v.KR)(!1);(0,n.wB)((()=>e.token),(e=>{a.value=e})),(0,n.wB)((()=>e.submittingToken),(e=>{o.value=e})),(0,n.wB)((()=>e.error),(e=>{s.value=e})),(0,n.wB)(a,(e=>{t("update:token",e)}));const i=()=>{t("submit")},c=()=>Ae(this,void 0,void 0,(function*(){r.value=!0,s.value="";try{const e=yield T();l.value=e}catch(Ne){console.error("Error fetching payment request:",Ne),s.value="Failed to generate payment request. Please try again."}finally{r.value=!1}})),u=()=>{l.value=""};return{tokenValue:a,submitting:o,errorMessage:s,handleSubmit:i,createPaymentRequest:c,paymentRequestString:l,loadingPaymentRequest:r,hidePaymentRequest:u,copyToClipboard:le}}});var De=a(9270),Ee=a(564);const $e=(0,V.A)(We,[["render",Me],["__scopeId","data-v-406b8315"]]),Ie=$e;ae()(We,"components",{QItemLabel:we.A,QInput:De.A,QBtn:fe.A,QSpinner:Ee.A,QIcon:ee.A});var Ke=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function l(e){try{i(n.next(e))}catch(t){s(t)}}function r(e){try{i(n["throw"](e))}catch(t){s(t)}}function i(e){e.done?a(e.value):o(e.value).then(l,r)}i((n=n.apply(e,t||[])).next())}))};const Qe=(0,v.KR)([]),Xe=(0,v.KR)(!1),Ne=(0,v.KR)(""),Be=()=>Ke(void 0,void 0,void 0,(function*(){Xe.value=!0,Ne.value="";try{const e=yield w(0,0);e.forEach((e=>{if(e.info)try{const t=JSON.parse(e.info);e.info=t.version||e.info}catch(t){}})),Qe.value=e}catch(e){console.error("Error fetching mints:",e),Ne.value="Error fetching mints."}finally{Xe.value=!1}})),Oe=e=>Qe.value.find((t=>t.url===e));function Ve(){return{mints:(0,v.tB)(Qe),loading:(0,v.tB)(Xe),error:Ne,fetchMints:Be,findMintByUrl:Oe}}var Pe=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function l(e){try{i(n.next(e))}catch(t){s(t)}}function r(e){try{i(n["throw"](e))}catch(t){s(t)}}function i(e){e.done?a(e.value):o(e.value).then(l,r)}i((n=n.apply(e,t||[])).next())}))};const ze=(0,n.pM)({name:"MintList",components:{MintSwapStats:_e,TokenInput:Ie},setup(){const e=(0,v.KR)(""),t=(0,v.KR)(!1),a=(0,v.KR)(!1),o=(0,v.KR)(null),{mints:s,loading:l,error:r,fetchMints:i}=Ve(),c=[{name:"url",label:"URL",field:"url",sortable:!0,align:"left"},{name:"name",label:"Name",field:"name",sortable:!0,align:"left"},{name:"version",label:"Version",field:"info",sortable:!0,align:"left"},{name:"balance",label:"Balance (sat)",field:"balance",sortable:!0,align:"left"},{name:"sum_donations",label:"Total donated (sat)",field:"sum_donations",sortable:!0,align:"left"},{name:"updated_at",label:"Updated At",field:"updated_at",sortable:!0,align:"left"},{name:"state",label:"State",field:"state",sortable:!0,align:"left"},{name:"n_errors",label:"Errors",field:"n_errors",sortable:!0,align:"left"},{name:"n_mints",label:"Mints",field:"n_mints",sortable:!0,align:"left"},{name:"n_melts",label:"Melts",field:"n_melts",sortable:!0,align:"left"}];let u;const d=()=>Pe(this,void 0,void 0,(function*(){if(e.value){t.value=!0,r.value="";try{yield b({token:e.value}),e.value="",yield i()}catch(a){r.value="Error submitting token.",console.error(a)}finally{t.value=!1}}})),p=e=>{const t=/([Zz]|[+\-]\d{2}:\d{2})$/.test(e);let a=e;t||(a+="Z");const n=new Date(a);if(isNaN(n.getTime()))return console.error(`Invalid date string: ${e}`),"Invalid Date";const o={hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},s={year:"numeric",month:"short",day:"numeric"},l=n.toLocaleTimeString(void 0,o),r=n.toLocaleDateString(void 0,s);return`${l}, ${r}`},m=e=>{switch(e){case"OK":return{name:"check_circle",color:"positive"};case"WARN":return{name:"warning",color:"warning"};case"ERROR":return{name:"cancel",color:"negative"};case"UNKNOWN":default:return{name:"help",color:"grey-7"}}},f=(e,t)=>{o.value=t,a.value=!0};return(0,n.sV)((()=>{i(),u=window.setInterval(i,6e4)})),(0,n.xo)((()=>{void 0!==u&&clearInterval(u)})),{token:e,mints:s,columns:c,loading:l,submittingToken:t,error:r,submitToken:d,formatDate:p,getStateIcon:m,showSwapStats:a,selectedMint:o,onRowClick:f,copyToClipboard:le}}});var Ue=a(5880),je=a(7410),Ge=a(3954);const Ye=(0,V.A)(ze,[["render",m],["__scopeId","data-v-7b14b60c"]]),Ze=Ye;ae()(ze,"components",{QTable:Ue.A,QBtn:fe.A,QTooltip:je.A,QIcon:ee.A,QBadge:Ge.A});const He={class:"row justify-between items-center"},Je={class:"col-auto"},et={key:0,class:"q-pa-md flex justify-center"},tt={key:2,class:"q-pa-md"},at={key:3,class:"text-negative q-pa-md"},nt={key:4,class:"text-secondary q-pa-md"},ot={key:5,class:"text-secondary q-pa-md"};function st(e,t,a,o,r,i){const c=(0,n.g2)("q-item-label"),u=(0,n.g2)("q-icon"),d=(0,n.g2)("q-item-section"),p=(0,n.g2)("q-tooltip"),m=(0,n.g2)("q-btn"),v=(0,n.g2)("q-item"),f=(0,n.g2)("q-separator"),g=(0,n.g2)("q-spinner"),h=(0,n.g2)("q-list"),y=(0,n.g2)("MintSwapStats");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(h,{bordered:"",padding:"",class:"q-pa-md"},{default:(0,n.k6)((()=>[(0,n.bF)(c,{header:"",class:"text-h6 q-mb-md"},{default:(0,n.k6)((()=>t[1]||(t[1]=[(0,n.eW)("Recent Swaps")]))),_:1}),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.swaps,(a=>((0,n.uX)(),(0,n.CE)("div",{key:a.id},[(0,n.bF)(v,{clickable:"",class:"q-my-md",onClick:t=>e.openMintStats(a)},{default:(0,n.k6)((()=>[(0,n.bF)(d,{avatar:""},{default:(0,n.k6)((()=>[(0,n.bF)(u,{name:"OK"===a.state?"check_circle":"cancel",color:"OK"===a.state?"positive":"negative"},null,8,["name","color"])])),_:2},1024),(0,n.bF)(d,null,{default:(0,n.k6)((()=>[(0,n.Lk)("div",He,[t[2]||(t[2]=(0,n.Lk)("div",{class:"col-auto"},[(0,n.Lk)("span",{class:"text-bold"},"From:")],-1)),(0,n.Lk)("div",Je,[(0,n.bF)(c,{caption:""},{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(e.formatDate(a.created_at)),1)])),_:2},1024)])]),(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,s.v_)(a.from_url)+" ",1),(0,n.bF)(m,{flat:"",round:"",dense:"",size:"xs",icon:"content_copy",onClick:(0,l.D$)((t=>e.copyToClipboard(a.from_url,"Source mint URL copied to clipboard")),["stop"]),class:"copy-btn"},{default:(0,n.k6)((()=>[(0,n.bF)(p,null,{default:(0,n.k6)((()=>t[3]||(t[3]=[(0,n.eW)("Copy URL")]))),_:1})])),_:2},1032,["onClick"])])),_:2},1024),(0,n.bF)(c,null,{default:(0,n.k6)((()=>[t[5]||(t[5]=(0,n.Lk)("span",{class:"text-bold"},"To:",-1)),(0,n.eW)(" "+(0,s.v_)(a.to_url)+" ",1),(0,n.bF)(m,{flat:"",round:"",dense:"",size:"xs",icon:"content_copy",onClick:(0,l.D$)((t=>e.copyToClipboard(a.to_url,"Destination mint URL copied to clipboard")),["stop"]),class:"copy-btn"},{default:(0,n.k6)((()=>[(0,n.bF)(p,null,{default:(0,n.k6)((()=>t[4]||(t[4]=[(0,n.eW)("Copy URL")]))),_:1})])),_:2},1032,["onClick"])])),_:2},1024),(0,n.bF)(c,null,{default:(0,n.k6)((()=>[t[6]||(t[6]=(0,n.Lk)("span",{class:"text-bold"},"Amount:",-1)),(0,n.eW)(" "+(0,s.v_)(a.amount)+" sat ",1)])),_:2},1024),"OK"===a.state?((0,n.uX)(),(0,n.Wv)(c,{key:0,caption:""},{default:(0,n.k6)((()=>[t[7]||(t[7]=(0,n.Lk)("span",{class:"text-bold"},"Fee:",-1)),(0,n.eW)(" "+(0,s.v_)(a.fee)+" sat ",1),a.time_taken?((0,n.uX)(),(0,n.Wv)(c,{key:0,caption:""},{default:(0,n.k6)((()=>[(0,n.eW)(" Payment took "+(0,s.v_)(a.time_taken)+" ms ",1)])),_:2},1024)):(0,n.Q3)("",!0)])),_:2},1024)):(0,n.Q3)("",!0),"ERROR"===a.state&&a.error?((0,n.uX)(),(0,n.Wv)(c,{key:1,caption:""},{default:(0,n.k6)((()=>[t[8]||(t[8]=(0,n.Lk)("span",{class:"text-bold"},"Error:",-1)),(0,n.eW)(" "+(0,s.v_)(a.error),1)])),_:2},1024)):(0,n.Q3)("",!0)])),_:2},1024)])),_:2},1032,["onClick"]),(0,n.bF)(f)])))),128)),e.allLoaded||e.loadingMore||e.loadingNewSwaps?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",et,[(0,n.bF)(m,{label:"Load More Swaps",outline:"",color:"primary",onClick:e.loadMoreSwaps,disabled:e.loadingMore},null,8,["onClick","disabled"])])),e.loadingMore?((0,n.uX)(),(0,n.Wv)(g,{key:1,color:"primary",size:"50px",class:"q-my-md"})):(0,n.Q3)("",!0),e.loadingNewSwaps?((0,n.uX)(),(0,n.CE)("div",tt,[(0,n.bF)(g,{color:"primary",size:"30px"}),t[9]||(t[9]=(0,n.eW)(" Loading new swaps... "))])):(0,n.Q3)("",!0),e.error?((0,n.uX)(),(0,n.CE)("div",at,(0,s.v_)(e.error),1)):(0,n.Q3)("",!0),e.allLoaded&&e.swaps.length>0?((0,n.uX)(),(0,n.CE)("div",nt," All swaps loaded. ")):(0,n.Q3)("",!0),e.loadingInitial||0!==e.swaps.length||e.error?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",ot," No swaps found. "))])),_:1}),e.selectedMint?((0,n.uX)(),(0,n.Wv)(y,{key:0,modelValue:e.showSwapStats,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showSwapStats=t),mint:e.selectedMint},null,8,["modelValue","mint"])):(0,n.Q3)("",!0)])}var lt=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function l(e){try{i(n.next(e))}catch(t){s(t)}}function r(e){try{i(n["throw"](e))}catch(t){s(t)}}function i(e){e.done?a(e.value):o(e.value).then(l,r)}i((n=n.apply(e,t||[])).next())}))};const rt=(0,n.pM)({name:"SwapList",components:{MintSwapStats:_e},setup(){const e=(0,v.KR)([]),t=(0,v.KR)(!1),a=(0,v.KR)(!1),o=(0,v.KR)(!1),s=(0,v.KR)(""),l=(0,v.KR)(0),r=10,i=(0,v.KR)(!1),c=(0,v.KR)(!1),u=(0,v.KR)(null),{mints:d,fetchMints:p,findMintByUrl:m}=Ve(),f=(0,v.KR)(new Set);let g;const h=e=>{0===d.value.length&&p();const t=m(e.from_url);u.value=t||{id:e.from_id,url:e.from_url,name:"",balance:0,updated_at:e.created_at,state:e.state,n_errors:0,n_mints:0,n_melts:0},c.value=!0},y=e=>{const t=/([Zz]|[+\-]\d{2}:\d{2})$/.test(e);let a=e;t||(a+="Z");const n=new Date(a);if(isNaN(n.getTime()))return console.error(`Invalid date string: ${e}`),"Invalid Date";const o={hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},s={year:"numeric",month:"short",day:"numeric"},l=n.toLocaleTimeString(void 0,o),r=n.toLocaleDateString(void 0,s);return`${l}, ${r}`},w=n=>lt(this,void 0,void 0,(function*(){"initial"===n?t.value=!0:"more"===n?a.value=!0:"new"===n&&(o.value=!0),s.value="";try{if("initial"===n){const t=yield k(0,r);e.value=t,f.value=new Set(t.map((e=>e.id))),l.value=r,i.value=t.length<r}else if("more"===n){const t=yield k(l.value,r),a=t.filter((e=>!f.value.has(e.id)));a.forEach((e=>f.value.add(e.id))),e.value=[...e.value,...a],l.value+=r,t.length<r&&(i.value=!0)}else if("new"===n){const t=yield k(0,r),a=t.filter((e=>!f.value.has(e.id)));a.length>0&&(a.forEach((e=>f.value.add(e.id))),e.value=[...a,...e.value])}e.value.sort(((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()))}catch(c){s.value="Error fetching swaps.",console.error(c)}finally{"initial"===n?t.value=!1:"more"===n?a.value=!1:"new"===n&&(o.value=!1)}})),b=()=>lt(this,void 0,void 0,(function*(){i.value||a.value||(yield w("more"))})),_=()=>lt(this,void 0,void 0,(function*(){yield w("new")})),x=()=>lt(this,void 0,void 0,(function*(){yield p(),yield w("initial"),g=window.setInterval(_,6e4)}));return(0,n.xo)((()=>{void 0!==g&&clearInterval(g)})),(0,n.sV)((()=>{x()})),{swaps:e,loadingInitial:t,loadingMore:a,loadingNewSwaps:o,error:s,allLoaded:i,formatDate:y,loadMoreSwaps:b,copyToClipboard:le,selectedMint:u,showSwapStats:c,openMintStats:h}}});var it=a(386);const ct=(0,V.A)(rt,[["render",st],["__scopeId","data-v-203d7bef"]]),ut=ct;ae()(rt,"components",{QList:ge.A,QItemLabel:we.A,QItem:he.A,QItemSection:ye.A,QIcon:ee.A,QBtn:fe.A,QTooltip:je.A,QSeparator:it.A,QSpinner:Ee.A});const dt={class:"mint-graph-container"},pt={ref:"svgRef"},mt={key:0,class:"load-button-container"},vt={key:2,class:"text-negative q-pa-md"},ft={ref:"tooltip",class:"tooltip",style:{opacity:"0"}};function gt(e,t,a,o,l,r){const i=(0,n.g2)("q-card-section"),c=(0,n.g2)("q-btn"),u=(0,n.g2)("q-spinner"),d=(0,n.g2)("MintSwapStats"),p=(0,n.g2)("q-card");return(0,n.uX)(),(0,n.Wv)(p,{class:"bg-dark"},{default:(0,n.k6)((()=>[(0,n.bF)(i,{class:"bg-dark text-light"},{default:(0,n.k6)((()=>t[1]||(t[1]=[(0,n.Lk)("h2",{class:"text-h6"},"Mint Graph",-1)]))),_:1}),(0,n.Lk)("div",dt,[((0,n.uX)(),(0,n.CE)("svg",pt,null,512)),e.isLoaded?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",mt,[(0,n.bF)(c,{label:"Load Graph",outline:"",color:"primary",onClick:e.loadGraph,loading:e.loading},null,8,["onClick","loading"])])),e.loading?((0,n.uX)(),(0,n.Wv)(u,{key:1,color:"primary",size:"50px",class:"q-my-md"})):(0,n.Q3)("",!0),e.error?((0,n.uX)(),(0,n.CE)("div",vt,(0,s.v_)(e.error),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",ft,null,512)]),e.selectedMint?((0,n.uX)(),(0,n.Wv)(d,{key:0,modelValue:e.showSwapStats,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showSwapStats=t),mint:e.selectedMint},null,8,["modelValue","mint"])):(0,n.Q3)("",!0)])),_:1})}var ht=a(2302),yt=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function l(e){try{i(n.next(e))}catch(t){s(t)}}function r(e){try{i(n["throw"](e))}catch(t){s(t)}}function i(e){e.done?a(e.value):o(e.value).then(l,r)}i((n=n.apply(e,t||[])).next())}))};const wt=(0,n.pM)({name:"MintGraph",components:{MintSwapStats:_e},setup(){const e=(0,v.KR)(null),t=(0,v.KR)(null),a=(0,v.KR)(null),o=(0,v.KR)(!1),s=(0,v.KR)(""),l=(0,v.KR)(!1),r=(0,v.KR)(!1),i=(0,v.KR)(null);let c=null;const u=()=>yt(this,void 0,void 0,(function*(){o.value=!0,s.value="";try{a.value=yield _(),d(),l.value=!0}catch(e){s.value="Error fetching mint graph.",console.error(e)}finally{o.value=!1}})),d=()=>{if(!a.value||!e.value)return;const n=a.value.nodes.map((e=>Object.assign({},e))),o=new Map(n.map((e=>[e.id,e]))),s=a.value.edges.map((e=>{const t=o.get(e.from_id),a=o.get(e.to_id);return t&&a?{source:t,target:a,count:e.count,total_amount:e.total_amount,state:e.state}:(console.error("Invalid edge: source or target node not found"),null)})).filter((e=>null!==e));ht.Ltv(e.value).selectAll("*").remove();const l=e.value.clientWidth||800,u=e.value.clientHeight||400,d=ht.Ltv(e.value).attr("width","100%").attr("height","100%").attr("viewBox",`0 0 ${l} ${u}`).attr("preserveAspectRatio","xMidYMid meet"),v=ht.s_O().scaleExtent([.1,4]).on("zoom",(e=>{f.attr("transform",e.transform)})),f=d.append("g");d.call(v);const g=l<600?-100:-200,h=l<600?150:250;d.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","-0 -5 10 10").attr("refX",25).attr("refY",0).attr("orient","auto").attr("markerWidth",2).attr("markerHeight",2).attr("xoverflow","visible").append("svg:path").attr("d","M 0,-5 L 10,0 L 0,5").attr("fill","#aaa").style("stroke","none");const y=ht.Ltv(t.value);c=ht.tXi(n).force("link",ht.kJC(s).id((e=>e.id.toString())).distance(h).strength((e=>Math.log(e.count)/1e3))).force("charge",ht.xJS().strength(g)).force("center",ht.jTM(l/2,u/2)).force("x",ht.KS8(l/2).strength(.01)).force("y",ht.TSS(u/2).strength(.05)).on("tick",_);const w=f.append("g").attr("class","links").selectAll("path").data(s).enter().append("path").attr("stroke-width",(e=>Math.log(e.count)/2)).attr("stroke",(e=>"OK"===e.state?"#7b7":"#a66")).attr("stroke-opacity",.4).attr("fill","none").attr("marker-end","url(#arrowhead)").on("mouseover",((e,t)=>{y.style("opacity",1).html(`<strong>Edge:</strong><br>Count: ${t.count}<br>Total Amount: ${t.total_amount}`)})).on("mousemove",(e=>{y.style("left",`${e.clientX+10}px`).style("top",e.clientY-28+"px")})).on("mouseout",(()=>{y.style("opacity",0)})),b=f.append("g").attr("class","nodes").selectAll("circle").data(n).enter().append("circle").attr("r",10).attr("fill",(e=>m(e.state))).attr("stroke","#000").call(p(c)).on("mouseover",((e,t)=>{y.style("opacity",1).html(`<strong>Mint:</strong><br>Name: ${t.name||t.url}<br>Balance: ${t.balance}`)})).on("mousemove",(e=>{y.style("left",`${e.clientX+10}px`).style("top",e.clientY-28+"px")})).on("mouseout",(()=>{y.style("opacity",0)})).on("click",((e,t)=>{i.value={id:t.id,name:t.name||"",url:t.url||"",balance:t.balance,state:t.state,info:"",updated_at:(new Date).toISOString(),next_update:(new Date).toISOString(),n_errors:0,n_mints:0,n_melts:0,sum_donations:0},r.value=!0}));b.append("title").text((e=>`Name: ${e.name||e.url}\nBalance: ${e.balance}`));const k=f.append("g").attr("class","labels").selectAll("text").data(n).enter().append("text").attr("dx",20).attr("dy",".45em").text((e=>e.name||e.url||"")).attr("fill","#fff").style("font-weight","bold");function _(){w.attr("d",(e=>{const t=e.source,a=e.target,n=a.x-t.x,o=a.y-t.y,s=Math.sqrt(n*n+o*o);return`M${t.x},${t.y} A${s},${s} 0 0,1 ${a.x},${a.y}`})),b.attr("cx",(e=>e.x)).attr("cy",(e=>e.y)),k.attr("x",(e=>e.x)).attr("y",(e=>e.y))}},p=e=>{function t(t,a){t.active||e.alphaTarget(.3).restart(),a.fx=a.x,a.fy=a.y,t.sourceEvent.stopPropagation()}function a(e,t){t.fx=e.x,t.fy=e.y}function n(t,a){t.active||e.alphaTarget(0),a.fx=null,a.fy=null}return ht.$Er().on("start",t).on("drag",a).on("end",n)},m=e=>{switch(e){case"OK":return"green";case"WARN":return"yellow";case"ERROR":return"red";case"UNKNOWN":default:return"grey"}};return(0,n.sV)((()=>{})),(0,n.xo)((()=>{c&&c.stop()})),{svgRef:e,tooltipRef:t,loading:o,error:s,isLoaded:l,loadGraph:u,getStateColor:m,showSwapStats:r,selectedMint:i}}}),bt=(0,V.A)(wt,[["render",gt],["__scopeId","data-v-6d20227c"]]),kt=bt;ae()(wt,"components",{QCard:ue.A,QCardSection:pe.A,QBtn:fe.A,QSpinner:Ee.A});const _t={class:"q-px-md"},xt={class:"text-h5"},St={class:"text-h5"},Tt={class:"text-caption"},Lt={class:"text-h5"},Rt={class:"text-caption"},qt={class:"text-h5"},Ct={class:"text-caption"},Mt={key:1,class:"text-negative q-pa-md"};function Ft(e,t,a,o,l,r){const i=(0,n.g2)("q-separator"),c=(0,n.g2)("q-card-section"),u=(0,n.g2)("q-card"),d=(0,n.g2)("q-linear-progress");return(0,n.uX)(),(0,n.CE)("div",_t,[(0,n.bF)(u,{flat:"",class:"bg-dark text-white"},{default:(0,n.k6)((()=>[(0,n.bF)(i),(0,n.bF)(c,{class:"row items-start q-gutter-md"},{default:(0,n.k6)((()=>[(0,n.bF)(u,{class:"stat-card"},{default:(0,n.k6)((()=>[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[t[0]||(t[0]=(0,n.Lk)("div",{class:"text-subtitle1"},"Total Balance",-1)),(0,n.Lk)("div",xt,(0,s.v_)(e.formatNumber(e.stats.total_balance))+" sat",1)])),_:1})])),_:1}),(0,n.bF)(u,{class:"stat-card"},{default:(0,n.k6)((()=>[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[t[1]||(t[1]=(0,n.Lk)("div",{class:"text-subtitle1"},"Total Swaps",-1)),(0,n.Lk)("div",St,(0,s.v_)(e.formatNumber(e.stats.total_swaps)),1),(0,n.Lk)("div",Tt," Last 24h: "+(0,s.v_)(e.formatNumber(e.stats.total_swaps_24h)),1)])),_:1})])),_:1}),(0,n.bF)(u,{class:"stat-card"},{default:(0,n.k6)((()=>[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[t[2]||(t[2]=(0,n.Lk)("div",{class:"text-subtitle1"},"Total Amount Swapped",-1)),(0,n.Lk)("div",Lt,(0,s.v_)(e.formatNumber(e.stats.total_amount_swapped))+" sat",1),(0,n.Lk)("div",Rt," Last 24h: "+(0,s.v_)(e.formatNumber(e.stats.total_amount_swapped_24h))+" sat ",1)])),_:1})])),_:1}),(0,n.bF)(u,{class:"stat-card"},{default:(0,n.k6)((()=>[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[t[3]||(t[3]=(0,n.Lk)("div",{class:"text-subtitle1"},"Average Swap Time",-1)),(0,n.Lk)("div",qt,(0,s.v_)(e.formatTime(e.stats.average_swap_time)),1),(0,n.Lk)("div",Ct," Last 24h: "+(0,s.v_)(e.formatTime(e.stats.average_swap_time_24h)),1)])),_:1})])),_:1})])),_:1}),e.loading?((0,n.uX)(),(0,n.Wv)(d,{key:0,indeterminate:"",color:"primary",class:"q-mt-sm"})):(0,n.Q3)("",!0),e.error?((0,n.uX)(),(0,n.CE)("div",Mt,(0,s.v_)(e.error),1)):(0,n.Q3)("",!0)])),_:1})])}var At=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function l(e){try{i(n.next(e))}catch(t){s(t)}}function r(e){try{i(n["throw"](e))}catch(t){s(t)}}function i(e){e.done?a(e.value):o(e.value).then(l,r)}i((n=n.apply(e,t||[])).next())}))};const Wt=(0,n.pM)({name:"StatsCard",setup(){const e=(0,v.KR)({total_balance:0,total_swaps:0,total_swaps_24h:0,total_amount_swapped:0,total_amount_swapped_24h:0,average_swap_time:0,average_swap_time_24h:0}),t=(0,v.KR)(!1),a=(0,v.KR)("");let o;const s=()=>At(this,void 0,void 0,(function*(){t.value=!0,a.value="";try{e.value=yield x()}catch(n){a.value="Error fetching service statistics.",console.error(n)}finally{t.value=!1}})),l=e=>e.toLocaleString(),r=e=>{if(0===e)return"N/A";const t=e/1e3;if(t<60)return`${t.toFixed(1)} s`;{const e=t/60;return`${e.toFixed(1)} min`}};return(0,n.sV)((()=>{s(),o=window.setInterval(s,3e5)})),(0,n.xo)((()=>{void 0!==o&&clearInterval(o)})),{stats:e,loading:t,error:a,formatNumber:l,formatTime:r}}});var Dt=a(5859);const Et=(0,V.A)(Wt,[["render",Ft],["__scopeId","data-v-ef9ce3ee"]]),$t=Et;ae()(Wt,"components",{QCard:ue.A,QSeparator:it.A,QCardSection:pe.A,QLinearProgress:Dt.A});const It={class:"q-px-md"};function Kt(e,t,a,o,s,l){const r=(0,n.g2)("MintSwapBarChart"),i=(0,n.g2)("q-card-section"),c=(0,n.g2)("q-card");return(0,n.uX)(),(0,n.CE)("div",It,[(0,n.bF)(c,{class:"bg-dark text-white rounded-borders"},{default:(0,n.k6)((()=>[(0,n.bF)(i,null,{default:(0,n.k6)((()=>[(0,n.bF)(r,{swaps:e.swaps},null,8,["swaps"])])),_:1})])),_:1})])}var Qt=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,s){function l(e){try{i(n.next(e))}catch(t){s(t)}}function r(e){try{i(n["throw"](e))}catch(t){s(t)}}function i(e){e.done?a(e.value):o(e.value).then(l,r)}i((n=n.apply(e,t||[])).next())}))};const Xt=(0,n.pM)({name:"GlobalSwapBarChart",components:{MintSwapBarChart:z},props:{maxSwaps:{type:Number,default:200}},setup(e){const t=(0,v.KR)([]),a=(0,v.KR)(!1),o=(0,v.KR)("");let s;const l=()=>Qt(this,void 0,void 0,(function*(){a.value=!0,o.value="";try{const a=yield k(0,e.maxSwaps);t.value=a.sort(((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()))}catch(n){o.value="Error fetching swaps.",console.error(n)}finally{a.value=!1}}));return(0,n.sV)((()=>{l(),s=window.setInterval(l,6e4)})),(0,n.xo)((()=>{void 0!==s&&clearInterval(s)})),{swaps:t,loading:a,error:o}}}),Nt=(0,V.A)(Xt,[["render",Kt],["__scopeId","data-v-51361cf6"]]),Bt=Nt;ae()(Xt,"components",{QCard:ue.A,QCardSection:pe.A});const Ot=(0,n.pM)({name:"IndexPage",components:{MintList:Ze,SwapList:ut,MintGraph:kt,StatsCard:$t,GlobalSwapBarChart:Bt}}),Vt=(0,V.A)(Ot,[["render",o]]),Pt=Vt}}]);