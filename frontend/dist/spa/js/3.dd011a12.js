"use strict";(globalThis["webpackChunkcashu_auditor_frontend"]=globalThis["webpackChunkcashu_auditor_frontend"]||[]).push([[3],{8003:(t,e,n)=>{n.r(e),n.d(e,{default:()=>ot});var a=n(1758);function o(t,e,n,o,l,r){const i=(0,a.g2)("MintList"),s=(0,a.g2)("MintGraph"),c=(0,a.g2)("SwapList");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(i),(0,a.bF)(s),(0,a.bF)(c)],64)}var l=n(9104),r=n(8790);const i={class:"q-pa-md"},s={key:0,class:"text-negative q-pa-md"},c={class:"text-left"},u={class:"text-left"},d={class:"text-left"};function p(t,e,n,o,p,f){const v=(0,a.g2)("q-btn"),m=(0,a.g2)("q-spinner"),g=(0,a.g2)("q-input"),y=(0,a.g2)("q-card"),b=(0,a.g2)("q-icon"),h=(0,a.g2)("q-table");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",i,[(0,a.bF)(y,null,{default:(0,a.k6)((()=>[(0,a.bF)(g,{filled:"",modelValue:t.token,"onUpdate:modelValue":e[0]||(e[0]=e=>t.token=e),label:"Enter Token",onKeyup:(0,l.jR)(t.submitToken,["enter"])},{append:(0,a.k6)((()=>[(0,a.bF)(v,{label:"Submit",color:"primary",onClick:t.submitToken},null,8,["onClick"]),t.loading?((0,a.uX)(),(0,a.Wv)(m,{key:0,size:"50px",class:"q-my-md",color:"primary"})):(0,a.Q3)("",!0)])),_:1},8,["modelValue","onKeyup"])])),_:1})]),t.error?((0,a.uX)(),(0,a.CE)("div",s,(0,r.v_)(t.error),1)):(0,a.Q3)("",!0),(0,a.bF)(h,{title:"Mints",rows:t.mints,grid:t.$q.screen.xs,columns:t.columns,"row-key":"id",loading:t.loading,"hide-bottom":t.mints.length>0,"rows-per-page-options":[0]},{"body-cell-updated_at":(0,a.k6)((e=>[(0,a.Lk)("td",c,(0,r.v_)(t.formatDate(e.row.updated_at)),1)])),"body-cell-next_update":(0,a.k6)((e=>[(0,a.Lk)("td",u,(0,r.v_)(t.formatDate(e.row.next_update)),1)])),"body-cell-state":(0,a.k6)((t=>[(0,a.Lk)("td",d,[(0,a.bF)(b,{name:"OK"===t.row.state?"check_circle":"cancel",color:"OK"===t.row.state?"positive":"negative"},null,8,["name","color"])])])),_:1},8,["rows","grid","columns","loading","hide-bottom"])])}var f=n(8734),v=n(2303);const m=v.A.create({baseURL:"https://api.audit.8333.space",headers:{"Content-Type":"application/json"}}),g=m;var y=function(t,e,n,a){function o(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,l){function r(t){try{s(a.next(t))}catch(e){l(e)}}function i(t){try{s(a["throw"](t))}catch(e){l(e)}}function s(t){t.done?n(t.value):o(t.value).then(r,i)}s((a=a.apply(t,e||[])).next())}))};const b=(t=0,e=0)=>y(void 0,void 0,void 0,(function*(){const n=yield g.get("/mints/",{params:{skip:t,limit:e}});return console.log("API Response:",n.data),n.data})),h=t=>y(void 0,void 0,void 0,(function*(){const e=yield g.post("/mints/",t);return console.log("API Response:",e.data),e.data})),k=(t=0,e=10)=>y(void 0,void 0,void 0,(function*(){const n=yield g.get("/swaps/",{params:{skip:t,limit:e}});return console.log("API Response:",n.data),n.data})),_=()=>y(void 0,void 0,void 0,(function*(){const t=yield g.get("/graph/");return console.log("API Response:",t.data),t.data}));var x=function(t,e,n,a){function o(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,l){function r(t){try{s(a.next(t))}catch(e){l(e)}}function i(t){try{s(a["throw"](t))}catch(e){l(e)}}function s(t){t.done?n(t.value):o(t.value).then(r,i)}s((a=a.apply(t,e||[])).next())}))};const w=(0,a.pM)({name:"MintList",setup(){const t=(0,f.KR)(""),e=(0,f.KR)([]),n=(0,f.KR)(!1),o=(0,f.KR)(""),l=[{name:"url",label:"URL",field:"url",sortable:!0,align:"left"},{name:"name",label:"Name",field:"name",sortable:!0,align:"left"},{name:"balance",label:"Balance (sat)",field:"balance",sortable:!0,align:"left"},{name:"sum_donations",label:"Total donated (sat)",field:"sum_donations",sortable:!0,align:"left"},{name:"updated_at",label:"Updated At",field:"updated_at",sortable:!0,align:"left"},{name:"state",label:"State",field:"state",sortable:!0,align:"left"},{name:"n_errors",label:"Errors",field:"n_errors",sortable:!0,align:"left"},{name:"n_mints",label:"Mints",field:"n_mints",sortable:!0,align:"left"},{name:"n_melts",label:"Melts",field:"n_melts",sortable:!0,align:"left"}];let r;const i=()=>x(this,void 0,void 0,(function*(){n.value=!0,o.value="";try{e.value=yield b(0,0)}catch(t){o.value="Error fetching mints.",console.error(t)}finally{n.value=!1}})),s=()=>x(this,void 0,void 0,(function*(){if(t.value){n.value=!0,o.value="";try{yield h({token:t.value}),t.value="",yield i()}catch(e){o.value="Error submitting token.",console.error(e)}finally{n.value=!1}}})),c=t=>new Date(t).toLocaleString();return(0,a.sV)((()=>{i(),r=window.setInterval(i,6e4)})),(0,a.xo)((()=>{void 0!==r&&clearInterval(r)})),{token:t,mints:e,columns:l,loading:n,error:o,submitToken:s,formatDate:c}}});var A=n(2807),q=n(3316),L=n(9270),F=n(2374),K=n(564),R=n(5107),I=n(492),M=n(8582),Q=n.n(M);const X=(0,A.A)(w,[["render",p],["__scopeId","data-v-d3c0ea44"]]),C=X;Q()(w,"components",{QCard:q.A,QInput:L.A,QBtn:F.A,QSpinner:K.A,QTable:R.A,QIcon:I.A});const E={key:1,class:"text-negative q-pa-md"};function S(t,e,n,o,l,i){const s=(0,a.g2)("q-item-label"),c=(0,a.g2)("q-icon"),u=(0,a.g2)("q-item-section"),d=(0,a.g2)("q-item"),p=(0,a.g2)("q-separator"),f=(0,a.g2)("q-spinner"),v=(0,a.g2)("q-list");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(v,{bordered:"",padding:"",class:"q-pa-md"},{default:(0,a.k6)((()=>[(0,a.bF)(s,{header:"",class:"text-h6 q-mb-md"},{default:(0,a.k6)((()=>e[0]||(e[0]=[(0,a.eW)("Recent Swaps")]))),_:1}),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.swaps,(n=>((0,a.uX)(),(0,a.CE)("div",{key:n.id},[(0,a.bF)(d,{clickable:"",class:"q-my-md"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{avatar:""},{default:(0,a.k6)((()=>[(0,a.bF)(c,{name:"OK"===n.state?"check_circle":"cancel",color:"OK"===n.state?"positive":"negative"},null,8,["name","color"])])),_:2},1024),(0,a.bF)(u,null,{default:(0,a.k6)((()=>[(0,a.bF)(s,null,{default:(0,a.k6)((()=>[e[1]||(e[1]=(0,a.Lk)("span",{class:"text-bold"},"From:",-1)),(0,a.eW)(" "+(0,r.v_)(n.from_url),1)])),_:2},1024),(0,a.bF)(s,null,{default:(0,a.k6)((()=>[e[2]||(e[2]=(0,a.Lk)("span",{class:"text-bold"},"To:",-1)),(0,a.eW)(" "+(0,r.v_)(n.to_url),1)])),_:2},1024),(0,a.bF)(s,null,{default:(0,a.k6)((()=>[e[3]||(e[3]=(0,a.Lk)("span",{class:"text-bold"},"Amount:",-1)),(0,a.eW)(" "+(0,r.v_)(n.amount)+" sat ",1)])),_:2},1024),"OK"==n.state?((0,a.uX)(),(0,a.Wv)(s,{key:0,caption:""},{default:(0,a.k6)((()=>[e[4]||(e[4]=(0,a.Lk)("span",{class:"text-bold"},"Fee:",-1)),(0,a.eW)(" "+(0,r.v_)(n.fee)+" sat ",1),n.time_taken?((0,a.uX)(),(0,a.Wv)(s,{key:0,caption:""},{default:(0,a.k6)((()=>[(0,a.eW)("Payment took "+(0,r.v_)(n.time_taken)+" ms",1)])),_:2},1024)):(0,a.Q3)("",!0)])),_:2},1024)):(0,a.Q3)("",!0)])),_:2},1024),(0,a.bF)(u,{side:"",top:""},{default:(0,a.k6)((()=>[(0,a.bF)(s,{caption:""},{default:(0,a.k6)((()=>[(0,a.eW)((0,r.v_)(t.formatDate(n.created_at)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,a.bF)(p)])))),128)),t.loading?((0,a.uX)(),(0,a.Wv)(f,{key:0,color:"primary",size:"50px",class:"q-my-md"})):(0,a.Q3)("",!0),t.error?((0,a.uX)(),(0,a.CE)("div",E,(0,r.v_)(t.error),1)):(0,a.Q3)("",!0)])),_:1})])}var T=function(t,e,n,a){function o(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,l){function r(t){try{s(a.next(t))}catch(e){l(e)}}function i(t){try{s(a["throw"](t))}catch(e){l(e)}}function s(t){t.done?n(t.value):o(t.value).then(r,i)}s((a=a.apply(t,e||[])).next())}))};const $=(0,a.pM)({name:"SwapList",setup(){const t=(0,f.KR)([]),e=(0,f.KR)(!1),n=(0,f.KR)("");let o;const l=()=>T(this,void 0,void 0,(function*(){e.value=!0,n.value="";try{t.value=yield k(0,10),t.value.sort(((t,e)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()))}catch(a){n.value="Error fetching swaps.",console.error(a)}finally{e.value=!1}})),r=t=>new Date(t).toLocaleString();return(0,a.sV)((()=>{l(),o=window.setInterval(l,6e4)})),(0,a.xo)((()=>{void 0!==o&&clearInterval(o)})),{swaps:t,loading:e,error:n,formatDate:r}}});var W=n(3999),P=n(3796),D=n(124),O=n(5173),B=n(386);const V=(0,A.A)($,[["render",S],["__scopeId","data-v-10b8d9a3"]]),j=V;Q()($,"components",{QList:W.A,QItemLabel:P.A,QItem:D.A,QItemSection:O.A,QIcon:I.A,QSeparator:B.A,QSpinner:K.A});const U={class:"mint-graph-container"},Y={ref:"svgRef"},z={key:1,class:"text-negative q-pa-md"},G={ref:"tooltip",class:"tooltip",style:{opacity:"0"}};function N(t,e,n,o,l,i){const s=(0,a.g2)("q-spinner");return(0,a.uX)(),(0,a.CE)("div",U,[((0,a.uX)(),(0,a.CE)("svg",Y,null,512)),t.loading?((0,a.uX)(),(0,a.Wv)(s,{key:0,color:"primary",size:"50px",class:"q-my-md"})):(0,a.Q3)("",!0),t.error?((0,a.uX)(),(0,a.CE)("div",z,(0,r.v_)(t.error),1)):(0,a.Q3)("",!0),(0,a.Lk)("div",G,null,512)])}var H=n(5932),J=function(t,e,n,a){function o(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,l){function r(t){try{s(a.next(t))}catch(e){l(e)}}function i(t){try{s(a["throw"](t))}catch(e){l(e)}}function s(t){t.done?n(t.value):o(t.value).then(r,i)}s((a=a.apply(t,e||[])).next())}))};const Z=(0,a.pM)({name:"MintGraph",setup(){const t=(0,f.KR)(null),e=(0,f.KR)(null),n=(0,f.KR)(null),o=(0,f.KR)(!1),l=(0,f.KR)("");let r=null;const i=()=>J(this,void 0,void 0,(function*(){o.value=!0,l.value="";try{n.value=yield _(),s()}catch(t){l.value="Error fetching mint graph.",console.error(t)}finally{o.value=!1}})),s=()=>{if(!n.value||!t.value)return;const a=n.value.nodes.map((t=>Object.assign({},t))),o=new Map(a.map((t=>[t.id,t]))),l=n.value.edges.map((t=>{const e=o.get(t.from_id),n=o.get(t.to_id);return e&&n?{source:e,target:n,count:t.count,total_amount:t.total_amount,state:t.state}:(console.error("Invalid edge: source or target node not found"),null)})).filter((t=>null!==t));H.Ltv(t.value).selectAll("*").remove();const i=t.value.clientWidth||800,s=t.value.clientHeight||400,u=H.Ltv(t.value).attr("width","100%").attr("height","100%").attr("viewBox","-250 -200 800 550").attr("preserveAspectRatio","xMidYMid meet");u.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","-0 -5 10 10").attr("refX",25).attr("refY",0).attr("orient","auto").attr("markerWidth",6).attr("markerHeight",6).attr("xoverflow","visible").append("svg:path").attr("d","M 0,-5 L 10,0 L 0,5").attr("fill","#aaa").style("stroke","none");const d=H.Ltv(e.value);r=H.tXi(a).force("link",H.kJC(l).id((t=>t.id.toString())).distance(300)).force("charge",H.xJS().strength(-200)).force("center",H.jTM(i/2,s/2)).force("x",H.KS8(i/2).strength(.01)).force("y",H.TSS(s/2).strength(.1)).on("tick",m);const p=u.append("g").attr("class","links").selectAll("path").data(l).enter().append("path").attr("stroke-width",(t=>Math.sqrt(t.count))).attr("stroke",(t=>"OK"===t.state?"#7b7":"#a66")).attr("stroke-opacity",.5).attr("fill","none").attr("marker-end","url(#arrowhead)").on("mouseover",((t,e)=>{d.style("opacity",1).html(`<strong>Edge:</strong><br>Count: ${e.count}<br>Total Amount: ${e.total_amount}`)})).on("mousemove",(t=>{d.style("left",`${t.clientX+10}px`).style("top",t.clientY-28+"px")})).on("mouseout",(()=>{d.style("opacity",0)})),f=u.append("g").attr("class","nodes").selectAll("circle").data(a).enter().append("circle").attr("r",10).attr("fill",(t=>"OK"===t.state?"green":"red")).attr("stroke","#000").call(c(r)).on("mouseover",((t,e)=>{d.style("opacity",1).html(`<strong>Mint:</strong><br>Name: ${e.name||e.url}<br>Balance: ${e.balance}`)})).on("mousemove",(t=>{d.style("left",`${t.clientX+10}px`).style("top",t.clientY-28+"px")})).on("mouseout",(()=>{d.style("opacity",0)}));f.append("title").text((t=>`Name: ${t.name||t.url}\nBalance: ${t.balance}`));const v=u.append("g").attr("class","labels").selectAll("text").data(a).enter().append("text").attr("dx",20).attr("dy",".45em").text((t=>t.name||t.url||"")).attr("fill","#fff").style("font-weight","bold");function m(){p.attr("d",(t=>{const e=t.source,n=t.target,a=n.x-e.x,o=n.y-e.y,l=Math.sqrt(a*a+o*o);return`M${e.x},${e.y} A${l},${l} 0 0,1 ${n.x},${n.y}`})),f.attr("cx",(t=>t.x)).attr("cy",(t=>t.y)),v.attr("x",(t=>t.x)).attr("y",(t=>t.y))}},c=t=>{function e(e,n){e.active||t.alphaTarget(.3).restart(),n.fx=n.x,n.fy=n.y}function n(t,e){e.fx=t.x,e.fy=t.y}function a(e,n){e.active||t.alphaTarget(0),n.fx=null,n.fy=null}return H.$Er().on("start",e).on("drag",n).on("end",a)};let u;return(0,a.sV)((()=>{i(),u=window.setInterval(i,6e4)})),(0,a.xo)((()=>{r&&r.stop(),void 0!==u&&clearInterval(u)})),{svgRef:t,tooltipRef:e,loading:o,error:l}}}),tt=(0,A.A)(Z,[["render",N],["__scopeId","data-v-c57283ce"]]),et=tt;Q()(Z,"components",{QSpinner:K.A});const nt=(0,a.pM)({name:"IndexPage",components:{MintList:C,SwapList:j,MintGraph:et}}),at=(0,A.A)(nt,[["render",o]]),ot=at}}]);