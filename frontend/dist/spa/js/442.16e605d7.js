"use strict";(globalThis["webpackChunkcashu_auditor_frontend"]=globalThis["webpackChunkcashu_auditor_frontend"]||[]).push([[442],{4442:(e,t,a)=>{a.r(t),a.d(t,{default:()=>pe});var n=a(1758);function o(e,t,a,o,l,r){const i=(0,n.g2)("MintList"),s=(0,n.g2)("MintGraph"),c=(0,n.g2)("SwapList");return(0,n.uX)(),(0,n.CE)(n.FK,null,[t[0]||(t[0]=(0,n.Lk)("div",{class:"q-pa-md"},[(0,n.Lk)("h1",{class:"text-h6"},"Lightning Auditor"),(0,n.Lk)("p",null," Donate ecash from any Cashu mint so it can be audited perpetually. This app sends random Lightning payments between mints. Forever. The sats go in a circle until all is lost to fees or rugs. If a mint fails to pay an invoice, it is marked with a scary red label. ")],-1)),(0,n.bF)(i),(0,n.bF)(s),(0,n.bF)(c)],64)}var l=a(9104),r=a(8790);const i={class:"q-pa-md"},s={key:0,class:"text-negative q-pa-md"},c={class:"text-left"},d={class:"text-left"},u={class:"text-left"},p={class:"text-left"},v={class:"text-left"};function f(e,t,a,o,f,m){const g=(0,n.g2)("q-item-label"),y=(0,n.g2)("q-spinner"),h=(0,n.g2)("q-btn"),b=(0,n.g2)("q-input"),k=(0,n.g2)("q-icon"),w=(0,n.g2)("q-badge"),_=(0,n.g2)("q-table");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.Lk)("div",i,[(0,n.bF)(g,{class:"text-h6 q-mb-md",color:"white"},{default:(0,n.k6)((()=>t[1]||(t[1]=[(0,n.eW)("Donate ecash")]))),_:1}),(0,n.bF)(b,{filled:"",modelValue:e.token,"onUpdate:modelValue":t[0]||(t[0]=t=>e.token=t),label:"Enter Token",onKeyup:(0,l.jR)(e.submitToken,["enter"])},{append:(0,n.k6)((()=>[(0,n.bF)(h,{color:"primary",onClick:e.submitToken},{default:(0,n.k6)((()=>[e.loading?((0,n.uX)(),(0,n.Wv)(y,{key:0,size:"15px",class:"q-mr-sm",color:"white"})):(0,n.Q3)("",!0),t[2]||(t[2]=(0,n.eW)("Submit"))])),_:1},8,["onClick"])])),_:1},8,["modelValue","onKeyup"])]),e.error?((0,n.uX)(),(0,n.CE)("div",s,(0,r.v_)(e.error),1)):(0,n.Q3)("",!0),(0,n.bF)(_,{title:"Mints",rows:e.mints,columns:e.columns,"row-key":"id",loading:e.loading,"hide-bottom":e.mints.length>0,"rows-per-page-options":[0]},{"body-cell-updated_at":(0,n.k6)((t=>[(0,n.Lk)("td",c,(0,r.v_)(e.formatDate(t.row.updated_at)),1)])),"body-cell-next_update":(0,n.k6)((t=>[(0,n.Lk)("td",d,(0,r.v_)(e.formatDate(t.row.next_update)),1)])),"body-cell-state":(0,n.k6)((t=>[(0,n.Lk)("td",u,[(0,n.bF)(k,{name:e.getStateIcon(t.row.state).name,color:e.getStateIcon(t.row.state).color},null,8,["name","color"])])])),"body-cell-n_errors":(0,n.k6)((e=>[(0,n.Lk)("td",p,[(0,n.bF)(w,{color:e.row.n_errors>0&&"ERROR"==e.row.state?"negative":"grey-7"},{default:(0,n.k6)((()=>[(0,n.eW)((0,r.v_)(e.row.n_errors),1)])),_:2},1032,["color"])])])),"body-cell-n_melts":(0,n.k6)((e=>[(0,n.Lk)("td",v,[(0,n.bF)(w,{color:e.row.n_melts>0&&"OK"==e.row.state?"positive":"grey-7","text-color":"dark"},{default:(0,n.k6)((()=>[(0,n.eW)((0,r.v_)(e.row.n_melts),1)])),_:2},1032,["color"])])])),_:1},8,["rows","columns","loading","hide-bottom"])])}var m=a(8734),g=a(2303);const y=g.A.create({baseURL:"https://api.audit.8333.space",headers:{"Content-Type":"application/json"}}),h=y;var b=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function r(e){try{s(n.next(e))}catch(t){l(t)}}function i(e){try{s(n["throw"](e))}catch(t){l(t)}}function s(e){e.done?a(e.value):o(e.value).then(r,i)}s((n=n.apply(e,t||[])).next())}))};const k=(e=0,t=0)=>b(void 0,void 0,void 0,(function*(){const a=yield h.get("/mints/",{params:{skip:e,limit:t}});return console.log("API Response:",a.data),a.data})),w=e=>b(void 0,void 0,void 0,(function*(){const t=yield h.post("/mints/",e);return console.log("API Response:",t.data),t.data})),_=(e=0,t=10)=>b(void 0,void 0,void 0,(function*(){const a=yield h.get("/swaps/",{params:{skip:e,limit:t}});return console.log("API Response:",a.data),a.data})),x=()=>b(void 0,void 0,void 0,(function*(){const e=yield h.get("/graph/");return console.log("API Response:",e.data),e.data}));var R=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function r(e){try{s(n.next(e))}catch(t){l(t)}}function i(e){try{s(n["throw"](e))}catch(t){l(t)}}function s(e){e.done?a(e.value):o(e.value).then(r,i)}s((n=n.apply(e,t||[])).next())}))};const L=(0,n.pM)({name:"MintList",setup(){const e=(0,m.KR)(""),t=(0,m.KR)([]),a=(0,m.KR)(!1),o=(0,m.KR)(""),l=[{name:"url",label:"URL",field:"url",sortable:!0,align:"left"},{name:"name",label:"Name",field:"name",sortable:!0,align:"left"},{name:"version",label:"Version",field:"info",sortable:!0,align:"left"},{name:"balance",label:"Balance (sat)",field:"balance",sortable:!0,align:"left"},{name:"sum_donations",label:"Total donated (sat)",field:"sum_donations",sortable:!0,align:"left"},{name:"updated_at",label:"Updated At",field:"updated_at",sortable:!0,align:"left"},{name:"state",label:"State",field:"state",sortable:!0,align:"left"},{name:"n_errors",label:"Errors",field:"n_errors",sortable:!0,align:"left"},{name:"n_mints",label:"Mints",field:"n_mints",sortable:!0,align:"left"},{name:"n_melts",label:"Melts",field:"n_melts",sortable:!0,align:"left"}];let r;const i=()=>R(this,void 0,void 0,(function*(){a.value=!0,o.value="";try{t.value=yield k(0,0),t.value.forEach((e=>{e.info&&(e.info=u(e.info))}))}catch(e){o.value="Error fetching mints.",console.error(e)}finally{a.value=!1}})),s=()=>R(this,void 0,void 0,(function*(){if(e.value){a.value=!0,o.value="";try{yield w({token:e.value}),e.value="",yield i()}catch(t){o.value="Error submitting token.",console.error(t)}finally{a.value=!1}}})),c=e=>new Date(e).toLocaleString(),d=e=>{switch(e){case"OK":return{name:"check_circle",color:"positive"};case"WARN":return{name:"warning",color:"warning"};case"ERROR":return{name:"cancel",color:"negative"};case"UNKNOWN":default:return{name:"help",color:"grey-7"}}},u=e=>{try{const t=JSON.parse(e);return t.version}catch(t){return""}};return(0,n.sV)((()=>{i(),r=window.setInterval(i,6e4)})),(0,n.xo)((()=>{void 0!==r&&clearInterval(r)})),{token:e,mints:t,columns:l,loading:a,error:o,submitToken:s,formatDate:c,getStateIcon:d,getVersion:u}}});var A=a(2807),q=a(3796),S=a(9270),K=a(2374),M=a(564),Q=a(5107),F=a(492),E=a(3954),I=a(8582),C=a.n(I);const W=(0,A.A)(L,[["render",f],["__scopeId","data-v-2d64ac26"]]),X=W;C()(L,"components",{QItemLabel:q.A,QInput:S.A,QBtn:K.A,QSpinner:M.A,QTable:Q.A,QIcon:F.A,QBadge:E.A});const T={key:0,class:"q-pa-md flex justify-center"},N={key:2,class:"q-pa-md"},O={key:3,class:"text-negative q-pa-md"},$={key:4,class:"text-secondary q-pa-md"},D={key:5,class:"text-secondary q-pa-md"};function P(e,t,a,o,l,i){const s=(0,n.g2)("q-item-label"),c=(0,n.g2)("q-icon"),d=(0,n.g2)("q-item-section"),u=(0,n.g2)("q-item"),p=(0,n.g2)("q-separator"),v=(0,n.g2)("q-btn"),f=(0,n.g2)("q-spinner"),m=(0,n.g2)("q-list");return(0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(m,{bordered:"",padding:"",class:"q-pa-md"},{default:(0,n.k6)((()=>[(0,n.bF)(s,{header:"",class:"text-h6 q-mb-md"},{default:(0,n.k6)((()=>t[0]||(t[0]=[(0,n.eW)("Recent Swaps")]))),_:1}),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.swaps,(a=>((0,n.uX)(),(0,n.CE)("div",{key:a.id},[(0,n.bF)(u,{clickable:"",class:"q-my-md"},{default:(0,n.k6)((()=>[(0,n.bF)(d,{avatar:""},{default:(0,n.k6)((()=>[(0,n.bF)(c,{name:"OK"===a.state?"check_circle":"cancel",color:"OK"===a.state?"positive":"negative"},null,8,["name","color"])])),_:2},1024),(0,n.bF)(d,null,{default:(0,n.k6)((()=>[(0,n.bF)(s,null,{default:(0,n.k6)((()=>[t[1]||(t[1]=(0,n.Lk)("span",{class:"text-bold"},"From:",-1)),(0,n.eW)(" "+(0,r.v_)(a.from_url),1)])),_:2},1024),(0,n.bF)(s,null,{default:(0,n.k6)((()=>[t[2]||(t[2]=(0,n.Lk)("span",{class:"text-bold"},"To:",-1)),(0,n.eW)(" "+(0,r.v_)(a.to_url),1)])),_:2},1024),(0,n.bF)(s,null,{default:(0,n.k6)((()=>[t[3]||(t[3]=(0,n.Lk)("span",{class:"text-bold"},"Amount:",-1)),(0,n.eW)(" "+(0,r.v_)(a.amount)+" sat ",1)])),_:2},1024),"OK"===a.state?((0,n.uX)(),(0,n.Wv)(s,{key:0,caption:""},{default:(0,n.k6)((()=>[t[4]||(t[4]=(0,n.Lk)("span",{class:"text-bold"},"Fee:",-1)),(0,n.eW)(" "+(0,r.v_)(a.fee)+" sat ",1),a.time_taken?((0,n.uX)(),(0,n.Wv)(s,{key:0,caption:""},{default:(0,n.k6)((()=>[(0,n.eW)(" Payment took "+(0,r.v_)(a.time_taken)+" ms ",1)])),_:2},1024)):(0,n.Q3)("",!0)])),_:2},1024)):(0,n.Q3)("",!0),"ERROR"===a.state&&a.error?((0,n.uX)(),(0,n.Wv)(s,{key:1,caption:""},{default:(0,n.k6)((()=>[t[5]||(t[5]=(0,n.Lk)("span",{class:"text-bold"},"Error:",-1)),(0,n.eW)(" "+(0,r.v_)(a.error),1)])),_:2},1024)):(0,n.Q3)("",!0)])),_:2},1024),(0,n.bF)(d,{side:"",top:""},{default:(0,n.k6)((()=>[(0,n.bF)(s,{caption:""},{default:(0,n.k6)((()=>[(0,n.eW)((0,r.v_)(e.formatDate(a.created_at)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),(0,n.bF)(p)])))),128)),e.allLoaded||e.loadingMore||e.loadingNewSwaps?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",T,[(0,n.bF)(v,{label:"Load More Swaps",outline:"",color:"primary",onClick:e.loadMoreSwaps,disabled:e.loadingMore},null,8,["onClick","disabled"])])),e.loadingMore?((0,n.uX)(),(0,n.Wv)(f,{key:1,color:"primary",size:"50px",class:"q-my-md"})):(0,n.Q3)("",!0),e.loadingNewSwaps?((0,n.uX)(),(0,n.CE)("div",N,[(0,n.bF)(f,{color:"primary",size:"30px"}),t[6]||(t[6]=(0,n.eW)(" Loading new swaps... "))])):(0,n.Q3)("",!0),e.error?((0,n.uX)(),(0,n.CE)("div",O,(0,r.v_)(e.error),1)):(0,n.Q3)("",!0),e.allLoaded&&e.swaps.length>0?((0,n.uX)(),(0,n.CE)("div",$," All swaps loaded. ")):(0,n.Q3)("",!0),e.loadingInitial||0!==e.swaps.length||e.error?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",D," No swaps found. "))])),_:1})])}var B=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function r(e){try{s(n.next(e))}catch(t){l(t)}}function i(e){try{s(n["throw"](e))}catch(t){l(t)}}function s(e){e.done?a(e.value):o(e.value).then(r,i)}s((n=n.apply(e,t||[])).next())}))};const V=(0,n.pM)({name:"SwapList",setup(){const e=(0,m.KR)([]),t=(0,m.KR)(!1),a=(0,m.KR)(!1),o=(0,m.KR)(!1),l=(0,m.KR)(""),r=(0,m.KR)(0),i=10,s=(0,m.KR)(!1),c=(0,m.KR)(new Set);let d;const u=e=>new Date(e).toLocaleString(),p=n=>B(this,void 0,void 0,(function*(){"initial"===n?t.value=!0:"more"===n?a.value=!0:"new"===n&&(o.value=!0),l.value="";try{if("initial"===n){const t=yield _(0,i);e.value=t,c.value=new Set(t.map((e=>e.id))),r.value=i,s.value=t.length<i}else if("more"===n){const t=yield _(r.value,i),a=t.filter((e=>!c.value.has(e.id)));a.forEach((e=>c.value.add(e.id))),e.value=[...e.value,...a],r.value+=i,t.length<i&&(s.value=!0)}else if("new"===n){const t=yield _(0,i),a=t.filter((e=>!c.value.has(e.id)));a.length>0&&(a.forEach((e=>c.value.add(e.id))),e.value=[...a,...e.value])}e.value.sort(((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()))}catch(d){l.value="Error fetching swaps.",console.error(d)}finally{"initial"===n?t.value=!1:"more"===n?a.value=!1:"new"===n&&(o.value=!1)}})),v=()=>B(this,void 0,void 0,(function*(){s.value||a.value||(yield p("more"))})),f=()=>B(this,void 0,void 0,(function*(){yield p("new")})),g=()=>B(this,void 0,void 0,(function*(){yield p("initial"),d=window.setInterval(f,6e4)}));return(0,n.xo)((()=>{void 0!==d&&clearInterval(d)})),(0,n.sV)((()=>{g()})),{swaps:e,loadingInitial:t,loadingMore:a,loadingNewSwaps:o,error:l,allLoaded:s,formatDate:u,loadMoreSwaps:v}}});var U=a(3999),j=a(124),z=a(5173),G=a(386);const Y=(0,A.A)(V,[["render",P],["__scopeId","data-v-5a09f478"]]),J=Y;C()(V,"components",{QList:U.A,QItemLabel:q.A,QItem:j.A,QItemSection:z.A,QIcon:F.A,QSeparator:G.A,QBtn:K.A,QSpinner:M.A});const H={class:"mint-graph-container"},Z={ref:"svgRef"},ee={key:1,class:"text-negative q-pa-md"},te={ref:"tooltip",class:"tooltip",style:{opacity:"0"}};function ae(e,t,a,o,l,i){const s=(0,n.g2)("q-card-section"),c=(0,n.g2)("q-spinner"),d=(0,n.g2)("q-card");return(0,n.uX)(),(0,n.Wv)(d,{class:"bg-dark"},{default:(0,n.k6)((()=>[(0,n.bF)(s,{class:"bg-dark text-light"},{default:(0,n.k6)((()=>t[0]||(t[0]=[(0,n.Lk)("h2",{class:"text-h6"},"Mint Graph",-1)]))),_:1}),(0,n.Lk)("div",H,[((0,n.uX)(),(0,n.CE)("svg",Z,null,512)),e.loading?((0,n.uX)(),(0,n.Wv)(c,{key:0,color:"primary",size:"50px",class:"q-my-md"})):(0,n.Q3)("",!0),e.error?((0,n.uX)(),(0,n.CE)("div",ee,(0,r.v_)(e.error),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",te,null,512)])])),_:1})}var ne=a(5932),oe=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function r(e){try{s(n.next(e))}catch(t){l(t)}}function i(e){try{s(n["throw"](e))}catch(t){l(t)}}function s(e){e.done?a(e.value):o(e.value).then(r,i)}s((n=n.apply(e,t||[])).next())}))};const le=(0,n.pM)({name:"MintGraph",setup(){const e=(0,m.KR)(null),t=(0,m.KR)(null),a=(0,m.KR)(null),o=(0,m.KR)(!1),l=(0,m.KR)("");let r=null;const i=()=>oe(this,void 0,void 0,(function*(){o.value=!0,l.value="";try{a.value=yield x(),s()}catch(e){l.value="Error fetching mint graph.",console.error(e)}finally{o.value=!1}})),s=()=>{if(!a.value||!e.value)return;const n=a.value.nodes.map((e=>Object.assign({},e))),o=new Map(n.map((e=>[e.id,e]))),l=a.value.edges.map((e=>{const t=o.get(e.from_id),a=o.get(e.to_id);return t&&a?{source:t,target:a,count:e.count,total_amount:e.total_amount,state:e.state}:(console.error("Invalid edge: source or target node not found"),null)})).filter((e=>null!==e));ne.Ltv(e.value).selectAll("*").remove();const i=e.value.clientWidth||800,s=e.value.clientHeight||400,u=ne.Ltv(e.value).attr("width","100%").attr("height","100%").attr("viewBox","-250 -200 800 550").attr("preserveAspectRatio","xMidYMid meet");u.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","-0 -5 10 10").attr("refX",25).attr("refY",0).attr("orient","auto").attr("markerWidth",6).attr("markerHeight",6).attr("xoverflow","visible").append("svg:path").attr("d","M 0,-5 L 10,0 L 0,5").attr("fill","#aaa").style("stroke","none");const p=ne.Ltv(t.value);r=ne.tXi(n).force("link",ne.kJC(l).id((e=>e.id.toString())).distance(250).strength((e=>Math.sqrt(e.count)/100))).force("charge",ne.xJS().strength(-200)).force("center",ne.jTM(i/2,s/2)).force("x",ne.KS8(i/2).strength(.01)).force("y",ne.TSS(s/2).strength(.05)).on("tick",g);const v=u.append("g").attr("class","links").selectAll("path").data(l).enter().append("path").attr("stroke-width",(e=>Math.sqrt(e.count))).attr("stroke",(e=>"OK"===e.state?"#7b7":"#a66")).attr("stroke-opacity",.5).attr("fill","none").attr("marker-end","url(#arrowhead)").on("mouseover",((e,t)=>{p.style("opacity",1).html(`<strong>Edge:</strong><br>Count: ${t.count}<br>Total Amount: ${t.total_amount}`)})).on("mousemove",(e=>{p.style("left",`${e.clientX+10}px`).style("top",e.clientY-28+"px")})).on("mouseout",(()=>{p.style("opacity",0)})),f=u.append("g").attr("class","nodes").selectAll("circle").data(n).enter().append("circle").attr("r",10).attr("fill",(e=>d(e.state))).attr("stroke","#000").call(c(r)).on("mouseover",((e,t)=>{p.style("opacity",1).html(`<strong>Mint:</strong><br>Name: ${t.name||t.url}<br>Balance: ${t.balance}`)})).on("mousemove",(e=>{p.style("left",`${e.clientX+10}px`).style("top",e.clientY-28+"px")})).on("mouseout",(()=>{p.style("opacity",0)}));f.append("title").text((e=>`Name: ${e.name||e.url}\nBalance: ${e.balance}`));const m=u.append("g").attr("class","labels").selectAll("text").data(n).enter().append("text").attr("dx",20).attr("dy",".45em").text((e=>e.name||e.url||"")).attr("fill","#fff").style("font-weight","bold");function g(){v.attr("d",(e=>{const t=e.source,a=e.target,n=a.x-t.x,o=a.y-t.y,l=Math.sqrt(n*n+o*o);return`M${t.x},${t.y} A${l},${l} 0 0,1 ${a.x},${a.y}`})),f.attr("cx",(e=>e.x)).attr("cy",(e=>e.y)),m.attr("x",(e=>e.x)).attr("y",(e=>e.y))}},c=e=>{function t(t,a){t.active||e.alphaTarget(.3).restart(),a.fx=a.x,a.fy=a.y}function a(e,t){t.fx=e.x,t.fy=e.y}function n(t,a){t.active||e.alphaTarget(0),a.fx=null,a.fy=null}return ne.$Er().on("start",t).on("drag",a).on("end",n)},d=e=>{switch(e){case"OK":return"green";case"WARN":return"yellow";case"ERROR":return"red";case"UNKNOWN":default:return"grey"}};let u;return(0,n.sV)((()=>{i()})),(0,n.xo)((()=>{r&&r.stop(),void 0!==u&&clearInterval(u)})),{svgRef:e,tooltipRef:t,loading:o,error:l,getStateColor:d}}});var re=a(3316),ie=a(4189);const se=(0,A.A)(le,[["render",ae],["__scopeId","data-v-1153498e"]]),ce=se;C()(le,"components",{QCard:re.A,QCardSection:ie.A,QSpinner:M.A});const de=(0,n.pM)({name:"IndexPage",components:{MintList:X,SwapList:J,MintGraph:ce}}),ue=(0,A.A)(de,[["render",o]]),pe=ue}}]);